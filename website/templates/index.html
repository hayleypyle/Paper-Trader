{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper Trader</title>
    <link rel="stylesheet" href="{% static  'css/styles.css'%}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="{% static 'index.js' %}"></script>


</head>
<body>
    <h1>Paper Trader</h1>
    <div class="directions">
    <p>Use the drop down menu to view different charts containing stock closing data.
    Then input the quantity of shares you wish to purchase or sell in the portfolio.
    Lastly, use the "complete transaction" button to confirm your purchase or sale. </p>
    </div>

    <form method="GET" id="tickerform">
        {{form}}
    </form>
    <div class="main-container">
    <div id="apple">
    {% autoescape off %}
    {{aapl_plot_div|safe}}
    {% endautoescape %}
    </div>

    <div class="microsoft-container" id="microsoft">
        {% autoescape off %}
        {{msft_plot_div}}
        {% endautoescape %}
    </div>

    <div class="google-container" id="google">
    {% autoescape off %}
    {{goog_plot_div}}
    {% endautoescape %}
    </div>

<div class="buy-container">
    <h4>Portfolio</h4>
    <table>
        <tr>
            <th>Stock</th>
            <th>Shares Owned</th> 
            <th>Share Price</th>
            <th>Buy Quantity</th>
            <th>Sell Quantity</th>
        </tr>
        {% for share in shares %}
        <tr>
            <td>{{share.share_name}}</td>
            <td>{{share.shares_owned}}</td> 
            <td>{{share.share_price}}</td>
            <td><input type="text" id="buy" onchange="buyQuantity()"></input></td>
            <td><input type="text" id="sell" onchange="sellQuantity()"></input></td>
        </tr>

        {% endfor %}
    
    </table>
    <div class="money">
    <h4 id="total_price">Buy/Sell Total:{{share.total_price}}</h4>
    <h4 id="balance">Balance: $10000</h4>
    <button class="purchase-button">Complete Transaction</button>
    </div>

</div>

    <script>
        let selectElement = document.getElementById('ticker_field');

        selectElement.addEventListener('change', function() {

            document.getElementById('tickerform').submit();
        });

        function buyQuantity(){
            buy_quantity= document.getElementById("buy").value
            buy_count = 0;
            for(let i=0; i < buy_quantity.length; i++){
                if (parseInt(buy_quantity[i].value))
                    buy_count += parseInt(buy_quantity[i].value);
            console.log(buy_count);
        }
    }

        function sellQuantity(){
            sell_total= document.getElementById("sell").value
            console.log(sell_total)
        
        }
 

        

    </script>
</body>
</html>